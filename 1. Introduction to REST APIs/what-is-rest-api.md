# Что такое REST API?


Этот курс является практическим, но выполняя различные задания, будем периодически останавливаться и углубляться в некоторые более абстрактные понятия, чтобы заполнить их более подробно. Эта тема - один из тех моментов глубокого погружения в понятия. Здесь мы рассмотрим, что такое REST API, сравним его с другими типами API, такими как SOAP. API REST имеют общие характеристики, но не имеют однозначных протоколов, таких как его предшественник SOAP.

[Что такое API](#api)

[API, использующие протокол HTTP = веб-сервисы](#http)

[API-интерфейсы SOAP являются предшественниками REST API](#soap)

[REST - стиль, а не стандарт](#style)

[REST фокусируется на ресурсах, доступ к которым осуществляется через URL](#focus)

[Сама сеть следует за REST](#network)

[API REST не сохраняют состояния и кэшируются](#cash)

[API REST не используют файлы WSDL, но некоторые спецификации все же существуют](#somespec)

[Материалы к прочтению](#toread)

<a name="api"></a>
## Что такое API

В общем, API (Application Programming Interface) обеспечивает взаимодействие между двумя системами. Это как винтик, связывающий две детали, или как шестеренка, при помощи которой приводятся в движение две соседние шестеренки (как на картинке ниже).

![apigear](https://github.com/Starkovden/Documenting_APIs/blob/master/1.%20Introduction%20to%20REST%20APIs/pics/26.jpg?raw=true)

*API - как шестеренка, приводящая в движение две соседние шестеренки. Картинка взята с ресурса [flickr](https://www.flickr.com/photos/brentinoz/4221291984/in/photolist-7r2e3h-nhM5Kn-9PDqYT-7HSuP2-7g3xAd-8q4jPo-tayRY-2H3cN6-neAkck-7EuejF-dd6uSk-4WHXzW-7nQPxk-eTrHmi-9BczGJ-8LTBeU-4SBTBv-6n2Nub-7rSg96-JbqW-A5Zo9-5QKUDu-dghHFw-4gfkH4-6f51Po-41m6XU-9BcWD7-2VFgTi-6oBdBR-555yd1-4ocopJ-9qKfUg-9KhTbj-82Qzh9-7u4cEz-eTrH2B-fJZXmL-aTDbqV-7N1BFh-28i54x-aTDbSD-9kVJyu-fPzHRX-dv29a3-5cSUgy-4FeamA-9B9HhD-dZMGtX-boZyKp-65TnuR), [CC BY-ND 2.0](https://creativecommons.org/licenses/by-nd/2.0/legalcode)*

API часто получают данные из пользовательских интерфейсов. Джим Биссо, опытный технический писатель API в области Силиконовой долины, описал API, используя аналогию калькулятора компьютера. Когда нажимаем кнопки, скрытые функции взаимодействуют с другими компонентами для получения информации. Как только информация возвращается, калькулятор представляет данные обратно в графический интерфейс.

![calc](https://github.com/Starkovden/Documenting_APIs/blob/master/1.%20Introduction%20to%20REST%20APIs/pics/27.png?raw=true)

*Когда нажимаем кнопки, скрытые функции взаимодействуют с другими компонентами и выдают информацию*

API работают аналогичным образом. При нажатии на кнопку в интерфейсе, запускаются внутренние функции, чтобы передать и получить информацию. Но вместо того, чтобы получать информацию из одной и той же системы, веб-API вызывают удаленные сервисы в сети, чтобы получить их информацию.

В конечном счете, разработчики вызывают API незримо для пользователя для извлечения информации в свои приложения. Кнопка в графическом интерфейсе пользователя программно подключена для вызова внешних служб. Например, кнопки Twitter или Facebook, которые взаимодействуют с социальными сетями, или видео [Youtube](https://www.youtube.com/), которые извлекают видео с youtube.com, работают под управлением веб-API.

<a name="http"></a>
## API, использующие протокол HTTP = веб-сервисы

«Веб-сервис» - это веб-приложение, предоставляющее ресурсы в формате, используемом  другими компьютерами. Веб-сервисы включают в себя различные типы API, в том числе REST и SOAP API. Веб-сервисы - это, в основном, запросы и ответы между клиентами и серверами (компьютер запрашивает ресурс, а веб-сервис отвечает на запрос).

API, использующие протокол HTTP для передачи запросов и ответов, рассматриваются как «веб-сервисы». В случае веб-сервисов клиент, делающий запрос на ресурс, и сервер API, предоставляющий ответ, могут использовать любой язык программирования или платформу. Не имеет значения, какой ЯП или платформа будут использоваться, потому что запрос сообщения и ответ сделаны через общий веб-протокол HTTP.

Веб-протокол является частью прекрасного веб-сервисов: они независимы от языка и поэтому совместимы между различными платформами и системами. При документировании REST API не имеет значения, строят ли инженеры API с помощью Java, Ruby, Python или какого-либо другого языка. Запросы выполняются через HTTP, и ответы возвращаются через HTTP.

Диаграмма ниже показывает общую модель REST API:

![diagram](https://github.com/Starkovden/Documenting_APIs/blob/master/1.%20Introduction%20to%20REST%20APIs/pics/28.jpg?raw=true)

Как видно, между клиентом и сервером API существует запрос и ответ. Клиент и сервер могут быть основаны на любом языке, но HTTP - это протокол, используемый для передачи сообщения. Этот шаблон запроса и ответа, по сути, является принципом работы API REST.

Любой язык программирования, создающий запрос, будет по-своему отправлять веб-запрос и анализировать ответ на своем языке. Эти специфичные для языка функции отправки запросов и анализа ответов не являются частью REST API (хотя они могут быть предоставлены в [прилагаемом SDK](https://github.com/Starkovden/Documenting_APIs/blob/master/6.%20Non-reference%20API%20topics/6.8.%20SDKs%20and%20sample%20apps.md)). REST API не зависит от языка и обрабатывает входящую и исходящую информацию по HTTP.

<a name="soap"></a>
## API-интерфейсы SOAP являются предшественниками REST API

До того, как REST стал самым популярным веб-сервисом, SOAP (Simple Object Access Protocol) был гораздо более распространенным. Чтобы лучше понять REST, полезно иметь некоторое понимание SOAP. Заодно и увидеть, что отличает SOAP и REST.


SOAP - это стандартизированный протокол, который требует XML в качестве формата сообщений для запросов и ответов. Как стандартный протокол, формат сообщения обычно определяется с помощью файла WSDL (язык описания веб-служб).

Файл WSDL определяет разрешенные элементы и атрибуты в обмениваемых сообщениях. Файл WSDL является машиночитаемым и используется серверами, взаимодействующими друг с другом для облегчения связи.

Сообщения SOAP заключены в «конверт», который включает в себя заголовок и тело, используя определенную схему XML и пространство имен. Пример формата запроса и ответа SOAP см. [SOAP против REST 101: понимание различий](https://www.soapui.org/learn/api/soap-vs-rest-api.html).

Основная проблема с SOAP заключается в том, что формат сообщений XML слишком многословный и тяжелый. Особенно это проблематично в мобильных сценариях, где размер файла и пропускная способность играют решающее значение. Многословный формат сообщения замедляет время обработки, что делает взаимодействия SOAP вялым.

SOAP по-прежнему используется в enterprise приложениях (особенно в финансовых учреждениях) со связью server-to-server, но в последние годы SOAP вымещается REST, особенно для API открытых сетей.

<a name="style"></a>
## REST - стиль, а не стандарт

Как и SOAP, REST (Representational State Transfer) использует HTTP в качестве протокола передачи данных для запросов и ответов. Однако, в отличие от SOAP, REST является архитектурным стилем, а не стандартным протоколом. Вот почему REST API иногда называют RESTful API - REST - это общий стиль, которому следует API.

API-интерфейс RESTful может не соответствовать всем официальным характеристикам REST, указанным [доктором Роем Филдингом](https://en.wikipedia.org/wiki/Roy_Fielding), который впервые описал модель эту модель. Следовательно, API являются «RESTful» или «REST-подобными». (Некоторые разработчики настаивают на использовании термина «RESTful», когда API не соответствует всем характеристикам REST, но большинство людей просто называют их «REST API»)

В архитектурном стиле нет ограничений XML в качестве формата сообщения. API REST могут использовать любой формат сообщений, который хотят использовать разработчики API, включая XML, JSON, Atom, RSS, CSV, HTML и другие.

Несмотря на разнообразие параметров формата сообщений, большинство API REST используют JSON (нотацию объектов JavaScript) в качестве формата сообщений по умолчанию. Они используют JSON, потому что он обеспечивает легкий, простой и более гибкий формат сообщений, который увеличивает скорость связи. Облегченная природа JSON также позволяет выполнять сценарии мобильной разработки и легок для парсинга в Интернете с помощью JavaScript.

Напротив, в XML, XSLT больше используется для представления или, скорее, «преобразования» («T» в XSLT) содержимого, хранящегося на языке XML. XSLT обеспечивает удобочитаемость (а не обработку данных, хранящихся в формате XML).

<a name="focus"></a>
### REST фокусируется на ресурсах, доступ к которым осуществляется через URL

Другой отличительной чертой REST является то, что API-интерфейсы REST фокусируются на ресурсах (то есть вещах, а не действиях) и способах доступа к ресурсам. Ресурсы, как правило, являются разными типами информации. Вы получаете доступ к ресурсам через URL (Uniform Resource Locators), так же как переход к URL-адресу в вашем браузере позволяет подключиться к информационному ресурсу. URL-адреса сопровождаются методом, который указывает, как вы хотите взаимодействовать с ресурсом.

Общие методы включают GET (чтение), POST (создание), PUT (обновление) и DELETE (удаление). Конечная точка обычно включает параметры запроса, которые определяют более подробную информацию о представлении ресурса, который нужно увидеть. Например, можно указать (в параметре запроса) ограничение на отображение 5 экземпляров ресурса.

Вот пример, как выглядит конечная точка:

        http://apiserver.com/homes?limit=5&format=json

Конечная точка показывает весь путь к ресурсу. Однако в документации вы обычно разделяете этот URL на более конкретные части:

- Базовый путь (базовый URL или хост) относится к общему пути для API. В приведенном выше примере базовый путь - [http://apiserver.com](http://apiserver.com);
- Отношение конечной точки к конечному пути этой точки. В приведенном примере это `/homes`;
- `?limit=5&format=json` часть конечной точки содержит параметры строки запроса для этой точки.

В приведенном выше примере конечная точка получит ресурс «homes» и ограничит результат до 5 домов. Будет возвращен ответ в формате JSON.

Можно иметь несколько конечных точек, которые ссылаются на один и тот же ресурс. Вот один из вариантов:

        http://apiserver.com/homes/{home id}

Приведенный выше URL-адрес может быть конечной точкой, которая извлекает домашний ресурс, содержащий определенный идентификатор. То, что передается обратно с сервера на клиент, является «представлением» ресурса. Ресурс может иметь много разных представлений (показывая все дома или дома, которые соответствуют определенным критериям, или дома в определенном формате и т.д.), Но здесь мы хотим видеть дом с определенным идентификатором.

> Отношения между ресурсами и методами часто описывается в терминах «существительные» и «глаголы». Ресурс - это существительное, потому что это объект или вещь. Глагол - это то, что вы делаете с этим существительным. Объединяя существительные с глаголами, вы формируете язык REST.

Более подробно рассмотрим конечные точки в следующих разделах (например, в [Обзоре руководства описания API](https://github.com/Starkovden/Documenting_APIs/blob/master/3.%20Documenting%20API%20endpoints/3.2.%20API%20reference%20tutorial%20overview.md) мы рассмотрим каждое свойство ресурса). А здесь дан краткий обзор.

<a name="network"></a>
### Сама сеть следует за REST

Термины «запросы GET» и «ответы на сообщения», передаваемые по «протоколу HTTP», могут показаться незнакомыми, но это всего лишь официальная терминология REST для описания происходящего. Поскольку мы используем Интернет, мы уже знакомы с тем, как работают API-интерфейсы REST - сама сеть по сути следует стилю RESTful.

Если вы откроете браузер и перейдете на [https://idratherbewriting.com](https://idratherbewriting.com), вы действительно используете протокол HTTP (`http: //`) для отправки запроса GET на ресурс, доступный на веб-сервере. Ответ от сервера отправляет контент с этого ресурса обратно по протоколу HTTP. Ваш браузер - это просто клиент, который делает ответ на сообщение читаемым и знакомым нашему глазу.

![REST](https://github.com/Starkovden/Documenting_APIs/blob/master/1.%20Introduction%20to%20REST%20APIs/pics/29.jpg?raw=true)

 Можно увидеть этот ответ в curl, если открыть окно терминала и набрать `curl` [https://idratherbewriting.com](https://idratherbewriting.com). (Предполагается, что [curl установлен ](https://github.com/Starkovden/Documenting_APIs/blob/master/2.%20Using%20an%20API%20like%20a%20developer/2.4.%20curl%20intro%20and%20instalation.md))

 Сам Интернет является примером архитектуры стиля RESTful, а значит и то, как работают API REST, скорее всего, станет понятным тем, кто проходит этот курс.

<a name="cash"></a>
### API REST не сохраняют состояния запроса, но ответы могут кэшироваться


REST API не сохраняют свои состояния и могут кэшироваться. Отсутствие состояния означает, что каждый раз, когда вы обращаетесь к ресурсу через конечную точку, API предоставляет один и тот же ответ. Он не запоминает ваш последний запрос и не учитывает его при предоставлении нового ответа. Другими словами, нет ранее запомненных состояний, которые API учитывает при каждом запросе.

Ответы могут кэшироваться для повышения производительности. Если кэш браузера уже содержит информацию, запрашиваемую в запросе, браузер может просто вернуть информацию из кэша вместо того, чтобы снова стучаться на сервер.

Кэширование API REST аналогично кешированию веб-страниц. Браузер использует значение времени последнего изменения в заголовках HTTP, чтобы определить, нужно ли ему снова получать ресурс. Если содержимое не было изменено с момента последнего извлечения, вместо него можно использовать кэшированную копию. Кэширование увеличивает скорость ответа.

API REST имеют и другие характеристики, о которых можно узнать побольше в [этом видео](https://www.restapitutorial.com/lessons/whatisrest.html). Одна из таких характеристик включает ссылки в ответах, позволяющие пользователям переходить к дополнительным элементам. Эта функция называется HATEOAS, или Hypermedia As The Engine of State.

Изучение подробной теории REST не является целью курса, также, как и незнание подробной теории не станет проблемой документирования REST API. Тем не менее, существует множество технических книг, курсов и веб-сайтов, в которых более подробно рассматриваются концепции, ограничения и архитектура REST API, к которым при желании можно обращаться. Например, посмотрите [«Основы программирования: веб-сервисы» Дэвида Гасснера](https://www.lynda.com/Software-Development-tutorials/Foundations-Programming-Web-Services/126131-2.html) на [lynda.com](https://www.lynda.com/).

<a name="somespec"></a>
### API REST не используют файлы WSDL, но некоторые спецификации все же существуют

Важным аспектом API REST, особенно в контексте документации, является то, что они не используют файл WSDL для описания элементов и параметров, разрешенных в запросах и ответах.

Хотя и существует возможный файл WADL (Web Application Description Language), который можно использовать для описания API-интерфейсов REST, им используются редко, поскольку там неадекватно описываются все ресурсы, параметры, форматы сообщений и другие атрибуты API-интерфейса REST. , (Помните, что REST API - это архитектурный стиль, а не стандартизированный протокол.)

Чтобы понять, как взаимодействовать с REST API, нужно прочитать документацию по API. Необходимость читать документы делает роль технического писателя чрезвычайно важной для документирования API.

Некоторые формальные спецификации - например, [OpenAPI](https://github.com/Starkovden/Documenting_APIs/blob/master/4.%20OpenAPI%20specification%20and%20Swagger/4.2.%20Introduction%20to%20the%20OpenAPI%20spec%20and%20Swagger.md) и [RAML](https://github.com/Starkovden/Documenting_APIs/blob/master/10.%20API%20glossary%20and%20Resourses/10.6.%20RAML%20tutorial.md) - были разработаны для описания API REST. Когда вы описываете свой API с использованием спецификации OpenAPI или RAML, инструменты, которые могут читать эти спецификации (например, [Swagger UI](https://github.com/Starkovden/Documenting_APIs/blob/master/4.%20OpenAPI%20specification%20and%20Swagger/4.14.%20Swagger%20UI%20tutorial.md) или [консоль RAML API]()), будут генерировать вывод интерактивной документации.

Спецификация OpenAPI может заменить файл WSDL, более распространенный в SOAP. Такие инструменты, как [Swagger UI](https://github.com/Starkovden/Documenting_APIs/blob/master/4.%20OpenAPI%20specification%20and%20Swagger/4.14.%20Swagger%20UI%20tutorial.md), которые читают документы спецификаций, обычно создают интерактивную документацию (с использованием API-консолей или API-проводников) и позволяют вам тестировать вызовы REST и просматривать ответы прямо в браузере.

Но не ожидайте, что выходные данные документации Swagger UI или RAML API Console будут содержать все детали, которые потребуются пользователям для работы с вашим API. Например, эти выходные данные не будут включать информацию о [ключах авторизации](https://github.com/Starkovden/Documenting_APIs/blob/master/6.%20Non-reference%20API%20topics/6.4.%20Authentification%20and%20authorization.md), подробностях о рабочих процессах и взаимозависимостях между конечными точками и так далее. Вывод Swagger или RAML обычно содержит только адресную документацию, на которую обычно приходится только треть или половина всей необходимой документации (в зависимости от API).

В целом, API REST более разнообразны и гибки, чем API SOAP, и  почти всегда нужно читать документацию, чтобы понять, как взаимодействовать с API REST. Изучая API-интерфейсы REST, можно обнаружить, что они значительно отличаются друг от друга (особенно формат и отображение сайтов документации, которые мы рассмотрим в обзоре сайтов документации API), но все они имеют общие принципы и паттерны. В основе любого REST API лежит запрос и ответ, передаваемые через Интернет.

<a name="toread"></a>
## Материалы к прочтению

[REST: a FAQ](https://medium.com/@diogo.lucas/rest-a-faq-b3cd7ed62828)

[Learn REST: A RESTful Tutorial](https://www.restapitutorial.com/)
